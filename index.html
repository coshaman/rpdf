<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ëœë¤ PDF ìƒì„±ê¸°</title>

  <!-- jsPDF + html2canvas (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    :root{
      --bg:#0b0f19;
      --line:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);
      --accent:#7c3aed;
      --accent2:#22c55e;
    }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic", sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(124,58,237,.25), transparent 55%),
                  radial-gradient(900px 500px at 100% 0%, rgba(34,197,94,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{ max-width: 1100px; margin: 32px auto; padding: 0 16px; }
    .toolbar{
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 14px 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .left{ display:flex; flex-direction:column; gap:2px; padding: 2px 4px; }
    .title{ font-size: 16px; font-weight: 800; letter-spacing: -0.3px; }
    .subtitle{ font-size: 12px; color: var(--muted); }

    .controls{
      display:flex; gap:10px; flex-wrap: wrap; align-items:center; justify-content:flex-end;
    }
    .field{
      display:flex; gap:8px; align-items:center;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 8px 10px;
    }
    .field label{ font-size:12px; color: var(--muted2); user-select:none; }
    .field input, .field select{
      appearance:none; border:0; outline:0; background: transparent;
      color: var(--text); font-weight: 700; font-size: 12px; min-width: 66px;
    }
    .toggle{
      display:flex; align-items:center; gap:8px;
      padding: 8px 10px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      user-select:none;
      font-size:12px;
      color: var(--muted);
    }
    .toggle input{ width:16px; height:16px; accent-color: var(--accent); }

    .btn{
      border:0; outline:0; cursor:pointer;
      padding: 10px 14px;
      border-radius: 14px;
      font-weight: 800;
      color: white;
      background: linear-gradient(135deg, var(--accent), #2563eb);
      box-shadow: 0 10px 20px rgba(124,58,237,.25);
      transition: transform .08s ease;
      white-space:nowrap;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn.secondary{
      background: rgba(255,255,255,.06);
      border: 1px solid var(--line);
      box-shadow:none;
      color: var(--text);
    }

    .status{
      margin-top: 14px;
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 12px 14px;
      color: var(--muted);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
    }
    .bar{
      height: 8px; flex: 1; border-radius: 999px;
      background: rgba(255,255,255,.06);
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.08);
    }
    .bar > div{
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(124,58,237,.9), rgba(34,197,94,.85));
      transition: width .18s ease;
    }

    .grid{ margin-top: 18px; display:grid; grid-template-columns: 1fr; gap: 18px; }
    @media (min-width: 950px){ .grid{ grid-template-columns: 420px 1fr; align-items:start; } }

    .panel{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 18px;
      overflow:hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .panel .hd{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      display:flex; align-items:center; justify-content:space-between; gap: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    }
    .panel .hd b{ font-size: 12px; letter-spacing: -0.2px; }
    .panel .hd span{ font-size: 12px; color: var(--muted2); }
    .panel .bd{ padding: 12px 14px; color: var(--muted); font-size: 12px; line-height: 1.55; }

    .previewFrame{ padding: 12px; }
    .thumb{
      width:100%;
      aspect-ratio: 794 / 1123;
      background: rgba(255,255,255,.03);
      border: 1px dashed rgba(255,255,255,.18);
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(255,255,255,.55);
      font-size: 12px;
    }
    .smallNote{ color: rgba(255,255,255,.55); font-size: 12px; margin-top: 10px; line-height: 1.55; }

    /* Hidden render host */
    #pagesHost{ position: absolute; left: -99999px; top: 0; width: 794px; }
    .rendering *{ animation: none !important; transition: none !important; }

    /* A4 page base */
    .page{
      width: 794px; height: 1123px;
      background: white; color: #0b1220;
      position: relative; overflow:hidden; box-sizing: border-box;
      border-radius: 10px;
      margin: 0 0 18px 0;
      padding: 38px 44px;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
    }

    /* Shared components */
    .p-top{ display:flex; align-items:flex-start; justify-content:space-between; gap: 12px; padding-bottom: 10px; border-bottom: 1px solid rgba(15,23,42,.10); }
    .brand{ display:flex; gap: 10px; align-items:center; }
    .logo{ width: 30px; height: 30px; border-radius: 10px; background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(34,197,94,.85)); box-shadow: inset 0 0 0 1px rgba(255,255,255,.7); }
    .brand .meta{ display:flex; flex-direction:column; gap: 2px; }
    .brand .meta .name{ font-weight: 900; letter-spacing: -0.3px; font-size: 14px; }
    .brand .meta .tag{ font-size: 11px; color: rgba(15,23,42,.65); }
    .docmeta{ text-align:right; display:flex; flex-direction:column; gap: 4px; font-size: 11px; color: rgba(15,23,42,.65); }
    .docmeta .pill{ display:inline-block; padding: 4px 8px; border-radius: 999px; background: rgba(124,58,237,.10); color: rgba(88,28,135,.95); font-weight: 800; align-self:flex-end; }
    .p-title{ margin-top: 14px; display:flex; align-items:flex-end; justify-content:space-between; gap: 14px; }
    .p-title h1{ margin:0; font-size: 22px; letter-spacing: -0.6px; line-height: 1.1; }
    .p-title .sub{ margin-top: 6px; font-size: 12px; color: rgba(15,23,42,.65); max-width: 520px; }
    .badges{ display:flex; gap: 6px; flex-wrap:wrap; justify-content:flex-end; }
    .badge{ font-size: 10px; font-weight: 800; padding: 5px 8px; border-radius: 999px; border: 1px solid rgba(15,23,42,.12); background: rgba(15,23,42,.03); color: rgba(15,23,42,.78); }
    .badge.accent{ background: rgba(124,58,237,.10); color: rgba(88,28,135,.95); border-color: rgba(124,58,237,.18); }
    .badge.green{ background: rgba(34,197,94,.10); color: rgba(20,83,45,.95); border-color: rgba(34,197,94,.18); }

    .card{ border: 1px solid rgba(15,23,42,.10); border-radius: 14px; padding: 12px 12px; background: linear-gradient(180deg, rgba(15,23,42,.02), rgba(15,23,42,.01)); }
    .card h2{ margin:0 0 8px 0; font-size: 12px; letter-spacing: -0.2px; color: rgba(15,23,42,.82); }
    .card p{ margin:0; font-size: 11px; line-height: 1.55; color: rgba(15,23,42,.70); }

    .table{ width:100%; border-collapse: collapse; font-size: 10.5px; margin-top: 10px; overflow:hidden; border-radius: 12px; border: 1px solid rgba(15,23,42,.10); }
    .table th, .table td{ padding: 8px 8px; border-bottom: 1px solid rgba(15,23,42,.08); }
    .table th{ text-align:left; font-weight: 900; color: rgba(15,23,42,.82); background: rgba(15,23,42,.03); }
    .table td{ color: rgba(15,23,42,.72); }

    .chart{
      height: 170px; border-radius: 12px; border: 1px solid rgba(15,23,42,.10);
      background: radial-gradient(260px 120px at 30% 20%, rgba(124,58,237,.18), transparent 60%),
                  radial-gradient(240px 120px at 85% 35%, rgba(34,197,94,.16), transparent 60%),
                  rgba(15,23,42,.02);
      position: relative; overflow:hidden;
    }
    .spark{ position:absolute; left: 10px; right: 10px; bottom: 10px; top: 10px; }

    .footer{
      position:absolute; left: 44px; right: 44px; bottom: 26px;
      display:flex; align-items:center; justify-content:space-between; gap: 10px;
      padding-top: 10px; border-top: 1px solid rgba(15,23,42,.10);
      font-size: 10px; color: rgba(15,23,42,.55);
    }
    .watermark{
      position:absolute; right: -40px; top: 80px;
      transform: rotate(18deg);
      font-size: 54px; font-weight: 1000; letter-spacing: -2px;
      color: rgba(15,23,42,.05);
      user-select:none; pointer-events:none; white-space:nowrap;
    }

    /* Template-specific tweaks */
    .tpl-1 .page{ padding: 44px 52px; }
    .tpl-2 .page{ padding: 34px 38px; }
    .tpl-3 .page{ padding: 40px 44px; }
    .tpl-4 .page{ padding: 38px 44px; }
    .tpl-5 .page{ padding: 38px 44px; }

    /* Template 2: side rail */
    .rail{
      position:absolute; left:0; top:0; bottom:0; width: 70px;
      background: linear-gradient(180deg, rgba(124,58,237,.20), rgba(34,197,94,.14));
      border-right: 1px solid rgba(15,23,42,.10);
    }
    .rail .railText{
      position:absolute; left: 10px; top: 120px;
      transform: rotate(-90deg);
      font-size: 12px; font-weight: 900;
      letter-spacing: 1.0px;
      color: rgba(15,23,42,.50);
      white-space:nowrap;
    }

    /* Template 4: cover-ish */
    .coverHero{
      margin-top: 38px;
      padding: 18px 18px;
      border-radius: 18px;
      border: 1px solid rgba(15,23,42,.10);
      background: radial-gradient(420px 220px at 20% 20%, rgba(124,58,237,.20), transparent 60%),
                  radial-gradient(420px 220px at 90% 30%, rgba(34,197,94,.16), transparent 60%),
                  rgba(15,23,42,.02);
    }
    .coverHero h3{
      margin:0 0 8px 0;
      font-size: 14px;
      letter-spacing: -0.3px;
      color: rgba(15,23,42,.82);
    }
    .coverGrid{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }
    .miniCard{
      border: 1px solid rgba(15,23,42,.10);
      border-radius: 14px;
      padding: 12px 12px;
      background: rgba(255,255,255,.55);
    }
    .miniCard b{ display:block; font-size: 11px; color: rgba(15,23,42,.80); }
    .miniCard span{ display:block; margin-top: 5px; font-size: 10px; color: rgba(15,23,42,.58); line-height: 1.4; }

    /* Template 5: memo blocks */
    .memoRow{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .memo{
      border: 1px dashed rgba(15,23,42,.18);
      border-radius: 16px;
      padding: 12px 12px;
      background: rgba(15,23,42,.02);
    }
    .memo h4{
      margin:0 0 8px 0;
      font-size: 11px;
      letter-spacing: -0.2px;
      color: rgba(15,23,42,.80);
    }
    .memo p{
      margin:0;
      font-size: 10.8px;
      color: rgba(15,23,42,.65);
      line-height: 1.55;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="toolbar">
      <div class="left">
        <div class="title">ëœë¤ â€œê·¸ëŸ´ë“¯í•˜ì§€ë§Œ ë‚´ìš©ì€ ëœë¤â€ PDF ìƒì„±ê¸°</div>
        <div class="subtitle">ë©€í‹° íŒŒì¼ ë‹¤ìš´ë¡œë“œ(Zip ì—†ì´) Â· í…œí”Œë¦¿ 5ì¢… Â· ì €í•´ìƒë„ ëª¨ë“œ</div>
      </div>

      <div class="controls">
        <div class="field">
          <label>í˜ì´ì§€</label>
          <input id="minPages" type="number" value="10" min="1" max="50" />
          <span style="color:var(--muted2);font-size:12px;">~</span>
          <input id="maxPages" type="number" value="20" min="1" max="50" />
        </div>

        <div class="field">
          <label>ë¬¸ì„œ ìˆ˜</label>
          <input id="docCount" type="number" value="3" min="1" max="30" />
        </div>

        <div class="field">
          <label>í…œí”Œë¦¿</label>
          <select id="templateMode">
            <option value="random" selected>ëœë¤(ë¬¸ì„œë³„)</option>
            <option value="1">í…œí”Œë¦¿ 1</option>
            <option value="2">í…œí”Œë¦¿ 2</option>
            <option value="3">í…œí”Œë¦¿ 3</option>
            <option value="4">í…œí”Œë¦¿ 4</option>
            <option value="5">í…œí”Œë¦¿ 5</option>
          </select>
        </div>

        <label class="toggle" title="ë¹ ë¥´ê²Œ ìƒì„±(í’ˆì§ˆ/ìš©ëŸ‰ ê°ì†Œ)">
          <input id="lowRes" type="checkbox" />
          ì €í•´ìƒë„(ë¹ ë¦„)
        </label>

        <div class="field">
          <label>seed</label>
          <input id="seed" type="text" value="" placeholder="ë¹„ìš°ë©´ ëœë¤" />
        </div>

        <button class="btn secondary" id="btnPreview">ë¯¸ë¦¬ë³´ê¸°(1p)</button>
        <button class="btn secondary" id="btnOne">PDF 1ê°œ ë‹¤ìš´ë¡œë“œ</button>
        <button class="btn" id="btnMulti">ì—¬ëŸ¬ PDF ë‹¤ìš´ë¡œë“œ</button>
      </div>
    </div>

    <div class="status">
      <div id="statusText">ëŒ€ê¸° ì¤‘</div>
      <div class="bar" aria-hidden="true"><div id="progressBar"></div></div>
      <div id="statusRight">0%</div>
    </div>

    <div class="grid">
      <div class="panel">
        <div class="hd">
          <b>ì£¼ì˜</b>
          <span>ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ ì •ì±…</span>
        </div>
        <div class="bd">
          <div>â€¢ ì—¬ëŸ¬ íŒŒì¼ ì—°ì† ë‹¤ìš´ë¡œë“œëŠ” ë¸Œë¼ìš°ì €ê°€ ì°¨ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          <div>â€¢ ë§‰íˆë©´: ì£¼ì†Œì°½ ì™¼ìª½ ğŸ”’ â†’ ì‚¬ì´íŠ¸ ì„¤ì • â†’ <b>ìë™ ë‹¤ìš´ë¡œë“œ í—ˆìš©</b></div>
          <div>â€¢ ì €í•´ìƒë„ëŠ” ë¹ ë¥´ì§€ë§Œ í…ìŠ¤íŠ¸ ì„ ëª…ë„ê°€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          <div class="smallNote">ê¶Œì¥ ì„¤ì •: ë¬¸ì„œ 3~5ê°œ, í˜ì´ì§€ 10~15p</div>
        </div>
      </div>

      <div class="panel">
        <div class="hd">
          <b>ë¯¸ë¦¬ë³´ê¸°</b>
          <span>ì²« í˜ì´ì§€</span>
        </div>
        <div class="previewFrame">
          <div class="thumb" id="previewThumb">ë¯¸ë¦¬ë³´ê¸° ì—†ìŒ</div>
        </div>
      </div>
    </div>
  </div>

  <div id="pagesHost" aria-hidden="true"></div>

  <script>
    // ---------- RNG ----------
    function xmur3(str) {
      let h = 1779033703 ^ str.length;
      for (let i = 0; i < str.length; i++) {
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function() {
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        h ^= h >>> 16;
        return h >>> 0;
      };
    }
    function mulberry32(a) {
      return function() {
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }
    function makeRng(seedStr) {
      const seed = seedStr && seedStr.trim()
        ? seedStr.trim()
        : (crypto?.getRandomValues ? String(crypto.getRandomValues(new Uint32Array(1))[0]) : String(Math.floor(Math.random()*1e9)));
      const seedFn = xmur3(seed);
      return { seed, rand: mulberry32(seedFn()) };
    }
    const pick = (rand, arr) => arr[Math.floor(rand() * arr.length)];
    const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

    // ---------- Random content ----------
    const WORDS = ["ì •í•©ì„±","ì§€í‘œ","ê±°ë²„ë„ŒìŠ¤","í”„ë ˆì„ì›Œí¬","ì „ëµ","ë¡œë“œë§µ","ë¦¬ìŠ¤í¬","ì •ì±…","ê°€ì •","ë¶„ì„","ê´€ì¸¡","ì„¸ê·¸ë¨¼íŠ¸","ìš°ì„ ìˆœìœ„","ì»¨í…ìŠ¤íŠ¸","ì¸ì‚¬ì´íŠ¸","ë©”íŠ¸ë¦­","ë² ì´ìŠ¤ë¼ì¸","ê°€ì´ë“œë¼ì¸","ê¶Œê³ ì•ˆ","ìš”ì•½","ì „í™˜","ìƒí˜¸ì‘ìš©","ìŠ¤ì½”í”„","ê·¼ê±°","ê°€ì„¤","ê²€ì¦","í”„ë¡œí† ì½œ","ì „ìˆ ","ìš´ì˜","ê°œì„ ","ì•„í‚¤í…ì²˜","ì»´í”Œë¼ì´ì–¸ìŠ¤","ê°€ì‹œì„±","íš¨ìœ¨","ì¶”ì ì„±","í‘œì¤€","ì •ë ¬","ì ê²€","ì»¨íŠ¸ë¡¤"];
    const TOPICS = ["ìš´ì˜ ë¦¬í¬íŠ¸","ë‚´ë¶€ ì ê²€ ë©”ëª¨","ë¶„ê¸° ìš”ì•½","í”„ë¡œì íŠ¸ ë¸Œë¦¬í”„","ì •ì±… ì´ˆì•ˆ","ë¦¬ìŠ¤í¬ í‰ê°€","ì„±ê³¼ ëŒ€ì‹œë³´ë“œ","ì‹¤í–‰ ê³„íš","ì¡°ì§ ìš´ì˜ ê°€ì´ë“œ","í’ˆì§ˆ ì§€í‘œ ë¦¬ë·°","í”„ë¡œì„¸ìŠ¤ ì •ë¦¬","ëŒ€ì‘ ì‹œë‚˜ë¦¬ì˜¤","ìš”ì•½ ë³´ê³ ì„œ","ê°ì‚¬ ì²´í¬ë¦¬ìŠ¤íŠ¸","ê¸°ìˆ  ë©”ëª¨"];
    const TAGS = ["CONFIDENTIAL","INTERNAL","DRAFT","REVIEW","FYI","ARCHIVE"];
    const SECTIONS = ["ê°œìš”","ë°°ê²½","í˜„í™©","í•µì‹¬ ê´€ì°°","ê¶Œê³  ì‚¬í•­","ì´ìŠˆ/ë¦¬ìŠ¤í¬","ëŒ€ì‘ì•ˆ","ë¶€ë¡","ë©”íŠ¸ë¦­ ì •ì˜","ë³€ê²½ ì´ë ¥","ëª¨ë‹ˆí„°ë§","ì •ì±… ë§¤í•‘","ìš”ì•½ í‘œ"];

    function sentence(rand, minW=8, maxW=14) {
      const n = Math.floor(rand()*(maxW-minW+1))+minW;
      let s = [];
      for(let i=0;i<n;i++) s.push(pick(rand, WORDS));
      const ends = ["ì…ë‹ˆë‹¤.","ìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.","ì„ ì „ì œë¡œ í•©ë‹ˆë‹¤.","ì— ê¸°ë°˜í•©ë‹ˆë‹¤.","ì´ í•„ìš”í•©ë‹ˆë‹¤.","ì„ ê¶Œê³ í•©ë‹ˆë‹¤.","ì„ ê³ ë ¤í•©ë‹ˆë‹¤.","ì„ ë°˜ì˜í•©ë‹ˆë‹¤."];
      return s.join(" ") + pick(rand, ends);
    }
    function paragraph(rand, lines=3) {
      return Array.from({length: lines}, ()=>sentence(rand, 9, 16)).join(" ");
    }
    function titleLine(rand) {
      return `${pick(rand, TOPICS)} Â· ${pick(rand, SECTIONS)} (${pick(rand, WORDS)})`;
    }
    function shortDate(rand){
      const year = 2026;
      const month = String(1 + Math.floor(rand()*12)).padStart(2,'0');
      const day = String(1 + Math.floor(rand()*28)).padStart(2,'0');
      return `${year}-${month}-${day}`;
    }
    function fakeId(rand){
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let s = "";
      for(let i=0;i<10;i++) s += chars[Math.floor(rand()*chars.length)];
      return s;
    }
    function pct(rand){ return `${Math.floor(rand()*61)+20}%`; }
    function num(rand){ return (Math.floor(rand()*9000)+1000).toLocaleString("en-US"); }

    function sparkPath(rand, w=520, h=140, points=18){
      let xStep = w/(points-1);
      let d = "";
      let y = (rand()*0.6+0.2)*h;
      for(let i=0;i<points;i++){
        const x = i*xStep;
        y = clamp(y + (rand()-0.5)*h*0.20, h*0.10, h*0.90);
        d += (i===0 ? `M ${x.toFixed(1)} ${y.toFixed(1)}` : ` L ${x.toFixed(1)} ${y.toFixed(1)}`);
      }
      return d;
    }
    function makeSparkSvg(rand){
      const w=520, h=140;
      const d1 = sparkPath(rand, w, h, 18);
      const d2 = sparkPath(rand, w, h, 18);
      return `
        <svg class="spark" viewBox="0 0 ${w} ${h}" preserveAspectRatio="none">
          <defs>
            <linearGradient id="g1" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0%" stop-color="rgba(124,58,237,.85)"/>
              <stop offset="100%" stop-color="rgba(34,197,94,.75)"/>
            </linearGradient>
            <linearGradient id="g2" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0%" stop-color="rgba(15,23,42,.35)"/>
              <stop offset="100%" stop-color="rgba(15,23,42,.10)"/>
            </linearGradient>
          </defs>
          <path d="${d2}" fill="none" stroke="url(#g2)" stroke-width="6" stroke-linecap="round" opacity="0.45"/>
          <path d="${d1}" fill="none" stroke="url(#g1)" stroke-width="4" stroke-linecap="round"/>
          ${Array.from({length: 6}).map((_,i)=>{
            const y = ((i+1)/7)*h;
            return `<line x1="0" y1="${y}" x2="${w}" y2="${y}" stroke="rgba(15,23,42,.08)" stroke-width="1"/>`;
          }).join("")}
        </svg>
      `;
    }

    // ---------- Templates (5) ----------
    function commonHeader(rand, docSeed){
      const tag = pick(rand, TAGS);
      const docId = fakeId(rand);
      const date = shortDate(rand);
      return `
        <div class="p-top">
          <div class="brand">
            <div class="logo"></div>
            <div class="meta">
              <div class="name">RandomOps Studio</div>
              <div class="tag">Generated Report Â· seed=${docSeed}</div>
            </div>
          </div>
          <div class="docmeta">
            <div class="pill">${tag}</div>
            <div>Doc ID: ${docId}</div>
            <div>Date: ${date}</div>
          </div>
        </div>
      `;
    }

    function commonTitle(rand){
      const mainTitle = titleLine(rand);
      const sub = paragraph(rand, 2);
      const badges = [
        {t: pick(rand, SECTIONS), cls:"accent"},
        {t: pick(rand, ["PRIORITY","STANDARD","OPTIONAL","FOLLOW-UP","CHECKLIST"]), cls: pick(rand, ["","green"])},
        {t: pick(rand, ["v1.0","v1.1","v2.0","rev.A","rev.B"]), cls:""}
      ];
      return `
        <div class="p-title">
          <div>
            <h1>${mainTitle}</h1>
            <div class="sub">${sub}</div>
          </div>
          <div class="badges">
            ${badges.map(b=>`<div class="badge ${b.cls}">${b.t}</div>`).join("")}
          </div>
        </div>
      `;
    }

    function footer(pageNo, totalPages){
      return `
        <div class="footer">
          <div>RandomOps Studio Â· Generated Placeholder Document</div>
          <div>Page ${pageNo} / ${totalPages}</div>
        </div>
      `;
    }

    function template1(rand, pageNo, totalPages, docSeed){
      const rows = Array.from({length: 6}, () => ({
        a: pick(rand, ["í•­ëª©","ìš”ê±´","ê·œì¹™","ì‚¬ë¡€","ì¡°ê±´","ê¸°ì¤€"]) + " " + pick(rand, ["A","B","C","D","E"]),
        b: pick(rand, ["ìœ ì§€","ê²€í† ","ê°•í™”","ì™„í™”","ëŒ€ì²´","ë³´ë¥˜"]),
        c: pick(rand, ["ë†’ìŒ","ë³´í†µ","ë‚®ìŒ"]),
        d: pct(rand)
      }));
      return `
        <div class="page">
          <div class="watermark">${pick(rand, ["INTERNAL","DRAFT","CONFIDENTIAL","REVIEW COPY","FOR DISCUSSION"])}</div>
          ${commonHeader(rand, docSeed)}
          ${commonTitle(rand)}

          <div style="margin-top:16px; display:grid; grid-template-columns: 1.25fr .75fr; gap:14px;">
            <div>
              <div class="card">
                <h2>${pick(rand, ["í•µì‹¬ ìš”ì•½","ìƒíƒœ ê°œìš”","ê´€ì°° ë©”ëª¨","ê²°ë¡  ìš”ì§€"])}</h2>
                <p>${paragraph(rand, 4)}</p>

                <table class="table">
                  <thead><tr><th>í•­ëª©</th><th>ì²˜ë¦¬</th><th>ë“±ê¸‰</th><th>ì§„í–‰</th></tr></thead>
                  <tbody>
                    ${rows.map(r=>`<tr><td>${r.a}</td><td>${r.b}</td><td>${r.c}</td><td>${r.d}</td></tr>`).join("")}
                  </tbody>
                </table>

                <div style="margin-top:10px; display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                  <div class="card"><h2>ê¶Œê³  ì‚¬í•­</h2><p>${paragraph(rand,3)}</p></div>
                  <div class="card"><h2>ì£¼ì˜/ë¦¬ìŠ¤í¬</h2><p>${paragraph(rand,3)}</p></div>
                </div>
              </div>

              <div class="card" style="margin-top:12px;">
                <h2>ë©”íŠ¸ë¦­ ìŠ¤ëƒ…ìƒ·</h2>
                <div class="chart">${makeSparkSvg(rand)}</div>
                <p style="margin-top:10px;">${paragraph(rand, 2)}</p>
              </div>
            </div>

            <div style="display:flex; flex-direction:column; gap:10px;">
              ${kpiStack(rand)}
              <div class="card"><h2>ê°„ë‹¨ ë©”ëª¨</h2><p>${paragraph(rand, 3)}</p></div>
            </div>
          </div>

          ${footer(pageNo, totalPages)}
        </div>
      `;
    }

    function template2(rand, pageNo, totalPages, docSeed){
      // Side rail layout
      return `
        <div class="page">
          <div class="rail"><div class="railText">${pick(rand, ["OPS","RISK","POLICY","METRICS","AUDIT","BRIEF"])}</div></div>
          <div style="margin-left:70px;">
            <div class="watermark">${pick(rand, ["INTERNAL","DRAFT","CONFIDENTIAL","REVIEW COPY"])}</div>
            ${commonHeader(rand, docSeed)}
            ${commonTitle(rand)}

            <div style="margin-top:16px; display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
              <div class="card"><h2>ìš”ì•½</h2><p>${paragraph(rand, 5)}</p></div>
              <div class="card"><h2>í•µì‹¬ ì²´í¬</h2><p>${paragraph(rand, 5)}</p></div>
            </div>

            <div class="card" style="margin-top:12px;">
              <h2>ì¶”ì„¸(ê°„ì´)</h2>
              <div class="chart">${makeSparkSvg(rand)}</div>
              <div style="margin-top:10px; display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;">
                ${miniCards(rand, 3)}
              </div>
            </div>

            ${footer(pageNo, totalPages)}
          </div>
        </div>
      `;
    }

    function template3(rand, pageNo, totalPages, docSeed){
      // Dense table layout
      const rows = Array.from({length: 12}, () => ({
        a: pick(rand, SECTIONS),
        b: pick(rand, ["ì •ì˜","ì ìš©","ì˜ˆì™¸","ê²€í† ","ê´€ì°°"]),
        c: pick(rand, ["ì™„ë£Œ","ì§„í–‰","ëŒ€ê¸°","ë³´ë¥˜"]),
        d: pct(rand),
        e: pick(rand, ["ë‚®ìŒ","ë³´í†µ","ë†’ìŒ"])
      }));
      return `
        <div class="page">
          <div class="watermark">${pick(rand, ["AUDIT","REVIEW","DRAFT","INTERNAL"])}</div>
          ${commonHeader(rand, docSeed)}
          ${commonTitle(rand)}

          <div style="margin-top:16px; display:grid; grid-template-columns: 1fr; gap:12px;">
            <div class="card">
              <h2>ì •ì˜/í•­ëª© ë§¤íŠ¸ë¦­ìŠ¤</h2>
              <p>${paragraph(rand, 2)}</p>
              <table class="table">
                <thead><tr><th>ì„¹ì…˜</th><th>íƒ€ì…</th><th>ìƒíƒœ</th><th>ì§„í–‰</th><th>ë¦¬ìŠ¤í¬</th></tr></thead>
                <tbody>
                  ${rows.map(r=>`
                    <tr><td>${r.a}</td><td>${r.b}</td><td>${r.c}</td><td>${r.d}</td><td>${r.e}</td></tr>
                  `).join("")}
                </tbody>
              </table>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
              <div class="card"><h2>ë©”ëª¨</h2><p>${paragraph(rand, 4)}</p></div>
              <div class="card"><h2>ì¶”ê°€ ì‚¬í•­</h2><p>${paragraph(rand, 4)}</p></div>
            </div>
          </div>

          ${footer(pageNo, totalPages)}
        </div>
      `;
    }

    function template4(rand, pageNo, totalPages, docSeed){
      // Cover-ish hero
      const heroTitle = `${pick(rand, ["Executive Summary","Overview","Portfolio Snapshot","Quarterly Brief","Ops Digest"])} Â· ${pick(rand, ["Q1","Q2","Q3","Q4","H1","H2"])}`
      return `
        <div class="page">
          <div class="watermark">${pick(rand, ["FOR DISCUSSION","DRAFT","INTERNAL"])}</div>
          ${commonHeader(rand, docSeed)}

          <div class="coverHero">
            <h3>${heroTitle}</h3>
            <div style="font-size:22px; font-weight:1000; letter-spacing:-0.6px; color: rgba(15,23,42,.86);">
              ${titleLine(rand)}
            </div>
            <div style="margin-top:8px; font-size:12px; color: rgba(15,23,42,.65);">
              ${paragraph(rand, 2)}
            </div>
            <div class="coverGrid">
              ${miniCards(rand, 6)}
            </div>
          </div>

          <div class="card" style="margin-top:14px;">
            <h2>ì¶”ì„¸ ìš”ì•½</h2>
            <div class="chart">${makeSparkSvg(rand)}</div>
            <p style="margin-top:10px;">${paragraph(rand, 2)}</p>
          </div>

          ${footer(pageNo, totalPages)}
        </div>
      `;
    }

    function template5(rand, pageNo, totalPages, docSeed){
      // Memo blocks
      return `
        <div class="page">
          <div class="watermark">${pick(rand, ["MEMO","NOTE","DRAFT","INTERNAL"])}</div>
          ${commonHeader(rand, docSeed)}
          ${commonTitle(rand)}

          <div class="card" style="margin-top:16px;">
            <h2>ë©”ì¸ ë©”ëª¨</h2>
            <p>${paragraph(rand, 4)}</p>
          </div>

          <div class="memoRow">
            ${memoBlocks(rand, 4)}
          </div>

          <div class="card" style="margin-top:12px;">
            <h2>ê°„ë‹¨ ì‹œê°í™”</h2>
            <div class="chart">${makeSparkSvg(rand)}</div>
          </div>

          ${footer(pageNo, totalPages)}
        </div>
      `;
    }

    function miniCards(rand, n){
      return Array.from({length:n}).map(()=>`
        <div class="miniCard">
          <b>${pick(rand, ["Scope","Metric","Owner","Status","Risk","ETA","Delta","Budget"])}</b>
          <span>${sentence(rand, 4, 7)}</span>
        </div>
      `).join("");
    }

    function memoBlocks(rand, n){
      return Array.from({length:n}).map(()=>`
        <div class="memo">
          <h4>${pick(rand, ["ê´€ì°°","ê²°ì •","í›„ì†","ì´ìŠˆ","ê°€ì •","í•µì‹¬"])}</h4>
          <p>${paragraph(rand, 2)}</p>
        </div>
      `).join("");
    }

    function kpiStack(rand){
      const kpis = [
        {label: pick(rand, ["ì¢…í•© ì§€ìˆ˜","ì •í•©ì„± ì ìˆ˜","ë¦¬ìŠ¤í¬ ë²„í¼","ì²˜ë¦¬ íš¨ìœ¨","ê°€ì‹œì„±"]), value: num(rand), delta: pick(rand, ["+","-"]) + (Math.floor(rand()*18)+1) + "%"},
        {label: pick(rand, ["ì „í™˜ìœ¨","ëˆ„ì  í•­ëª©","ëˆ„ë½ë¥ ","ì •ì±… ì»¤ë²„ë¦¬ì§€","ì˜¤ë¥˜ìœ¨"]), value: pct(rand), delta: pick(rand, ["+","-"]) + (Math.floor(rand()*12)+1) + "%"},
        {label: pick(rand, ["ëˆ„ì  ì´ë²¤íŠ¸","ê²€ì¦ ê±´ìˆ˜","ìƒ˜í”Œ ìˆ˜","ëŒ€ìƒ ë²”ìœ„","ìƒíƒœ ë³€ê²½"]), value: num(rand), delta: pick(rand, ["+","-"]) + (Math.floor(rand()*25)+1) + "%"},
      ];
      const bars = [Math.floor(rand()*60)+25, Math.floor(rand()*60)+25, Math.floor(rand()*60)+25];
      return kpis.map((k, idx)=>`
        <div class="card">
          <div style="display:flex; justify-content:space-between; gap:10px;">
            <div>
              <div style="font-size:10.5px; font-weight:900; color: rgba(15,23,42,.70);">${k.label}</div>
              <div style="font-size:18px; font-weight:1000; letter-spacing:-0.8px;">${k.value}</div>
              <div style="font-size:10px; color: rgba(15,23,42,.55); margin-top:3px;">
                ë³€ë™: ${k.delta} Â· ê¸°ì¤€: ${pick(rand, ["ìµœê·¼ 7ì¼","ìµœê·¼ 30ì¼","ë¶„ê¸° ëˆ„ì ","ì—°ê°„ ëˆ„ì "])}
              </div>
              <div style="height:8px; border-radius:999px; background: rgba(15,23,42,.06); border: 1px solid rgba(15,23,42,.08); overflow:hidden; margin-top:8px;">
                <div style="height:100%; width:${bars[idx]}%; background: linear-gradient(90deg, rgba(124,58,237,.75), rgba(34,197,94,.65));"></div>
              </div>
            </div>
            <div class="badge ${pick(rand, ["accent","green",""])}">${pick(rand, ["OK","WATCH","INFO"])}</div>
          </div>
        </div>
      `).join("");
    }

    function renderTemplate(tpl, rand, pageNo, totalPages, docSeed){
      switch (tpl){
        case 1: return template1(rand, pageNo, totalPages, docSeed);
        case 2: return template2(rand, pageNo, totalPages, docSeed);
        case 3: return template3(rand, pageNo, totalPages, docSeed);
        case 4: return template4(rand, pageNo, totalPages, docSeed);
        case 5: return template5(rand, pageNo, totalPages, docSeed);
        default: return template1(rand, pageNo, totalPages, docSeed);
      }
    }

    // ---------- UI state ----------
    const elHost = document.getElementById("pagesHost");
    const elPreview = document.getElementById("previewThumb");
    const elStatus = document.getElementById("statusText");
    const elBar = document.getElementById("progressBar");
    const elRight = document.getElementById("statusRight");

    function setProgress(p, text){
      const pct = Math.floor(p*100);
      elBar.style.width = pct + "%";
      elRight.textContent = pct + "%";
      if (text) elStatus.textContent = text;
    }

    function getPageRange(){
      const min = parseInt(document.getElementById("minPages").value || "10", 10);
      const max = parseInt(document.getElementById("maxPages").value || "20", 10);
      const a = clamp(min, 1, 50);
      const b = clamp(max, 1, 50);
      return { min: Math.min(a,b), max: Math.max(a,b) };
    }
    function getDocCount(){
      const n = parseInt(document.getElementById("docCount").value || "1", 10);
      return clamp(n, 1, 30);
    }
    function getTemplateMode(){
      const v = document.getElementById("templateMode").value;
      if (v === "random") return "random";
      const n = parseInt(v, 10);
      return [1,2,3,4,5].includes(n) ? n : "random";
    }
    function getRenderQuality(){
      const low = document.getElementById("lowRes").checked;
      // lowRes: faster + smaller. High: more crisp but slower.
      return low
        ? { scale: 1.25, jpeg: 0.78 }
        : { scale: 2.0,  jpeg: 0.92 };
    }

    function resolveBaseSeed(){
      const baseSeedInput = document.getElementById("seed").value || "";
      const { seed: baseSeed } = makeRng(baseSeedInput);
      return baseSeed;
    }

    function chooseDocTemplate(baseRand, templateMode){
      if (templateMode === "random") return 1 + Math.floor(baseRand() * 5);
      return templateMode;
    }

    // Build pages into hidden host for a given docSeed + tpl
    function buildPagesForDoc(docSeed, tpl){
      const { min, max } = getPageRange();
      const { rand } = makeRng(docSeed);
      const total = Math.floor(rand()*(max-min+1))+min;

      elHost.innerHTML = "";
      elHost.classList.add("rendering");

      // Wrap pagesHost with a template class for subtle CSS variations
      elHost.className = "";
      elHost.id = "pagesHost";
      elHost.classList.add("tpl-" + tpl);

      for(let i=1;i<=total;i++){
        elHost.insertAdjacentHTML("beforeend", renderTemplate(tpl, rand, i, total, docSeed));
      }

      elHost.classList.remove("rendering");
      return { total };
    }

    async function renderFirstPreview(){
      setProgress(0.02, "ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘...");
      const baseSeed = resolveBaseSeed();
      const docSeed = `${baseSeed}-doc1`;

      // pick template using stable docSeed RNG for determinism
      const { rand: tRand } = makeRng(docSeed + "-tpl");
      const tplMode = getTemplateMode();
      const tpl = (tplMode === "random") ? (1 + Math.floor(tRand() * 5)) : tplMode;

      // only build 1 page for preview
      const { rand } = makeRng(docSeed);
      elHost.innerHTML = "";
      elHost.className = "";
      elHost.id = "pagesHost";
      elHost.classList.add("tpl-" + tpl);
      elHost.insertAdjacentHTML("beforeend", renderTemplate(tpl, rand, 1, 1, docSeed));

      const first = elHost.querySelector(".page");
      const q = getRenderQuality();
      setProgress(0.20, `ë¯¸ë¦¬ë³´ê¸° ë Œë”ë§ ì¤‘... (tpl ${tpl})`);
      const canvas = await html2canvas(first, { scale: q.scale, backgroundColor: "#ffffff", useCORS: true });

      elPreview.innerHTML = `<img alt="preview" src="${canvas.toDataURL("image/png")}" style="width:100%;height:auto;border-radius:12px;display:block;">`;
      setProgress(1, `ë¯¸ë¦¬ë³´ê¸° ì™„ë£Œ (base seed=${baseSeed}, tpl=${tpl})`);
    }

    async function createPdfBlobForDoc(docSeed, tpl, progressCb){
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: "p", unit: "pt", format: "a4" });

      const { total } = buildPagesForDoc(docSeed, tpl);
      const pages = Array.from(elHost.querySelectorAll(".page"));

      const q = getRenderQuality();
      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = pdf.internal.pageSize.getHeight();

      for(let i=0;i<pages.length;i++){
        if (progressCb) progressCb(i, pages.length);

        const canvas = await html2canvas(pages[i], {
          scale: q.scale,
          backgroundColor: "#ffffff",
          useCORS: true
        });
        const imgData = canvas.toDataURL("image/jpeg", q.jpeg);

        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, "JPEG", 0, 0, pageW, pageH, undefined, "FAST");
      }

      const blob = pdf.output("blob");
      return { blob, pages: total };
    }

    function downloadBlob(blob, filename){
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      // small delay helps on some browsers when multiple downloads happen
      setTimeout(()=>URL.revokeObjectURL(url), 1500);
    }

    function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

    async function downloadOne(){
      setProgress(0.02, "PDF 1ê°œ ìƒì„± ì¤€ë¹„...");
      const baseSeed = resolveBaseSeed();
      const docSeed = `${baseSeed}-doc1`;

      // deterministic template per doc
      const { rand: tRand } = makeRng(docSeed + "-tpl");
      const tplMode = getTemplateMode();
      const tpl = (tplMode === "random") ? (1 + Math.floor(tRand() * 5)) : tplMode;

      const { blob, pages } = await createPdfBlobForDoc(docSeed, tpl, (i, n) => {
        const p = 0.08 + 0.88*(i/n);
        setProgress(p, `PDF ìƒì„± ì¤‘... (1ê°œ, tpl ${tpl}) (${i+1}/${n}p)`);
      });

      setProgress(0.98, "ë‹¤ìš´ë¡œë“œ ì¤€ë¹„...");
      const filename = `random-placeholder_${baseSeed}_01of01_tpl${tpl}_${pages}p.pdf`;
      downloadBlob(blob, filename);
      setProgress(1, `ì™„ë£Œ: ${filename}`);
    }

    async function downloadManyFiles(){
      const count = getDocCount();
      setProgress(0.01, `ë©€í‹° PDF ìƒì„± ì‹œì‘ (ë¬¸ì„œ ${count}ê°œ)`);

      const baseSeed = resolveBaseSeed();
      const tplMode = getTemplateMode();

      for(let d=1; d<=count; d++){
        const docSeed = `${baseSeed}-doc${d}`;

        // doc-specific template (deterministic)
        const { rand: tRand } = makeRng(docSeed + "-tpl");
        const tpl = (tplMode === "random") ? (1 + Math.floor(tRand() * 5)) : tplMode;

        // document progress
        setProgress(0.03 + 0.90*((d-1)/count), `ë¬¸ì„œ ${d}/${count} ìƒì„± ì¤€ë¹„... (tpl ${tpl})`);

        const { blob, pages } = await createPdfBlobForDoc(docSeed, tpl, (i, n) => {
          const docProgress = (i+1)/n;
          const overall = 0.03 + 0.90 * (((d-1) + docProgress) / count);
          setProgress(overall, `ë¬¸ì„œ ${d}/${count} ìƒì„± ì¤‘... (tpl ${tpl}) (${i+1}/${n}p)`);
        });

        const filename = `random-placeholder_${baseSeed}_${String(d).padStart(2,"0")}of${String(count).padStart(2,"0")}_tpl${tpl}_${pages}p.pdf`;
        downloadBlob(blob, filename);

        // Browser-friendly delay between downloads
        await sleep(400);
      }

      setProgress(1, `ì™„ë£Œ: ${count}ê°œ ë‹¤ìš´ë¡œë“œ ì‹œë„ (ì°¨ë‹¨ë˜ë©´ ìë™ ë‹¤ìš´ë¡œë“œ í—ˆìš© í•„ìš”)`);
    }

    // Wire up
    document.getElementById("btnPreview").addEventListener("click", () => {
      renderFirstPreview().catch(err => { console.error(err); setProgress(1, "ì˜¤ë¥˜: ë¯¸ë¦¬ë³´ê¸° ì‹¤íŒ¨ (ì½˜ì†” í™•ì¸)"); });
    });
    document.getElementById("btnOne").addEventListener("click", () => {
      downloadOne().catch(err => { console.error(err); setProgress(1, "ì˜¤ë¥˜: PDF ìƒì„± ì‹¤íŒ¨ (ì½˜ì†” í™•ì¸)"); });
    });
    document.getElementById("btnMulti").addEventListener("click", () => {
      downloadManyFiles().catch(err => { console.error(err); setProgress(1, "ì˜¤ë¥˜: ë©€í‹° ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ (ì½˜ì†” í™•ì¸)"); });
    });

    // Auto preview
    renderFirstPreview().catch(()=>{});
  </script>
</body>
</html>
